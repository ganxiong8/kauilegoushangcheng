!function(){if($.cookie("cookiesid")&&$.cookie("cookienum")){var i=$.cookie("cookienum").split(",");console.log(i);var s=0;$.each(i,function(i,t){s+=+t}),setTimeout(function(){$(".car_num").html(s)},200)}var t=location.search.substring(1).split("=")[1];$.ajax({url:"../php/details.php",data:{sid:t},dataType:"json"}).done(function(i){$("#smallpic").attr("src",i.url),$("#bpic").attr("src",i.url),$("#numsid").html(i.sid),$(".sm_tit").html(i.smtitle),$(".tit").html(i.title),$("title").html(i.title),$(".price_now").html(i.price);var t=i.urls.split(","),s="";$.each(t,function(i,t){s+='<li class="img_item"><a href="javascript:;"><img src="'+t+'"/></a></li>'}),$(".img_list").html(s)})}(),function(){$("#sf").width($("#spic").width()*$("#bf").width()/$("#bpic").width()),$("#sf").height($("#spic").height()*$("#bf").height()/$("#bpic").height());var o=$("#bpic").width()/$("#spic").width();$("#spic").hover(function(){$("#sf").css("visibility","visible"),$("#bf").css("visibility","visible"),$(this).on("mousemove",function(i){var t=i.pageX-$(".sp_l").offset().left-$("#sf").width()/2,s=i.pageY-$(".sp_l").offset().top-$("#sf").height()/2;t<0?t=0:t>=$("#spic").width()-$("#sf").width()&&(t=$("#spic").width()-$("#sf").width()),s<0?s=0:s>=$("#spic").height()-$("#sf").height()&&(s=$("#spic").height()-$("#sf").height()),$("#sf").css("left",t),$("#sf").css("top",s),$("#bpic").css("left",-t*o),$("#bpic").css("top",-s*o)})},function(){$("#sf").css("visibility","hidden"),$("#bf").css("visibility","hidden")}),$(".img_list").on("click","li",function(){var i=$(this).find("img").attr("src");$("#smallpic").attr("src",i),$("#bpic").attr("src",i)});var t=5;$(".r_btn").on("click",function(){var i=$(".img_list li");i.length>t&&(t++,$(".l_btn").css("color","#333"),i.length==t&&$(".r_btn").css("color","#fff"),$(".img_list").animate({left:-(t-5)*(i.eq(0).innerWidth()+10)}))}),$(".l_btn").on("click",function(){var i=$(".img_list li");5<t&&(t--,$(".r_btn").css("color","#333"),t<=5&&$(".l_btn").css("color","#fff"),$(".img_list").animate({left:-(t-5)*(i.eq(0).innerWidth()+10)}))})}(),function(){var i=$(".btn_reduce"),t=$(".btn_add"),s=$(".add_sub .text"),o=s.val();t.on("click",function(){99<=o||o++,s.val(o)}),i.on("click",function(){o<=1||o--,s.val(o)}),s.on("input",function(){var i=parseInt($(this).val());/^\d+$/g.test(i)?99<=i?$(this).val(99):i<=0?$(this).val(1):$(this).val(i):$(this).val(1)})}(),function(){var c=[],e=[];$(".code_buy").on("click",function(){var i=$(this).parents(".sp_box").find("#numsid").html();if($.cookie("cookiesid")&&$.cookie("cookienum")&&(c=$.cookie("cookiesid").split(","),e=$.cookie("cookienum").split(",")),-1!=$.inArray(i,c)){var t=parseInt(e[$.inArray(i,c)])+parseInt($(".add_sub .text").val());e[$.inArray(i,c)]=t,$.cookie("cookienum",e.toString(),{expires:7})}else c.push(i),$.cookie("cookiesid",c.toString(),{expires:7}),e.push($(".add_sub .text").val()),$.cookie("cookienum",e.toString(),{expires:7});if($.cookie("cookiesid")&&$.cookie("cookienum")){var s=$.cookie("cookienum").split(",");console.log(s);var o=0;$.each(s,function(i,t){o+=+t}),setTimeout(function(){$(".car_num").html(o)},200)}alert("添加购物车成功")})}();